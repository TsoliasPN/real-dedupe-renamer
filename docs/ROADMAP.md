# Roadmap

## How to use this roadmap (for humans and agents)
- Pick one item, mark its status, and log intent in `docs/PROJECT_LOG.md` before coding.
- Keep changes small; stop early if scope grows and mark the item [Paused].
- If you abandon work, mark [Abandoned] with a short reason and any partial artifacts.
- When done, mark [Done] and add a brief result note (tests run, files touched).

Status tags: [Planned], [In Progress], [Paused], [Blocked], [Abandoned], [Done]

## Now
- [Done] Enlarge help icon to 16px and align top-right. User value: clearer help affordance without clutter. Technical approach: render the SVG-based icon at 16px and align it to the top-right of the layout grid. Effort: XS. Dependencies: none. Risks: minor spacing shifts. Result: help icon renders at 16px and sits tighter to the top-right. Tests: not run.
- [Done] Use SVG help icon for rendering. User value: cleaner help icon that matches the provided SVG. Technical approach: draw the SVG-based icon with a small canvas and bundle the SVG for sizing. Effort: XS. Dependencies: none. Risks: minor theme mismatch for icon colors. Result: help icon now matches the SVG styling. Tests: not run.
- [Done] Add help icon PNG asset. User value: discreet help icon looks like standard app help affordance. Technical approach: add 12/14/16px filled-circle ? PNGs and use 14px by default. Effort: XS. Dependencies: none. Risks: asset bundling in PyInstaller. Result: help icon uses a PNG asset with size variants. Tests: not run.
- [Done] Reduce top padding from help icon header. User value: remove wasted vertical space while keeping the help icon top-right. Technical approach: move the help icon into the main grid row and remove the extra header frame. Effort: XS. Dependencies: none. Risks: minor layout shifts. Result: help icon sits top-right without extra header space. Tests: not run.
- [Done] Help icon moved to top-right. User value: discreet access without cluttering primary controls. Technical approach: move the ? icon to a top-right header area and make it a minimal clickable label. Effort: XS. Dependencies: none. Risks: discoverability if too subtle. Result: help is now a small top-right icon link. Tests: not run.
- [Done] Discreet help icon in top-right. User value: access help without visual clutter. Technical approach: replace the Help button with a question-mark icon aligned to the top-right that opens the help menu. Effort: XS. Dependencies: none. Risks: discoverability if the icon is too subtle. Result: Help is now a ? icon on the top-right. Tests: not run.
- [Done] Help access without menu bar. User value: reclaim vertical space while keeping help easy to find. Technical approach: remove the menubar and add a Help button that opens the existing How to use/Optional checks dialogs. Effort: XS. Dependencies: none. Risks: discoverability if button placement is unclear. Result: Help button replaces the menubar without losing help access. Tests: not run.
- [Done] Status box border continuity. User value: clean, uninterrupted status panel borders. Technical approach: adjust the status panel layout to avoid broken frame lines and ensure consistent borders. Effort: XS. Dependencies: none. Risks: minor layout changes. Result: status panel now uses a framed box with continuous borders. Tests: not run.
- [Done] Simplified confirm dialog layout: Cancel on left, Review in Advanced separated below. User value: reduce confusion in destructive confirmations. Technical approach: custom simplified confirm dialog with a primary button row and a separate review action below. Effort: XS. Dependencies: none. Risks: minor layout regressions. Result: simplified confirm now shows Cancel on the left with Review in Advanced in a separate row. Tests: not run.
- [Done] Move confirm-delete Cancel button to bottom-left. User value: clearer safe action placement in the confirm dialog. Technical approach: adjust confirm dialog button layout so Cancel acknowledges from the left. Effort: XS. Dependencies: none. Risks: minor UI consistency changes. Result: cancel action now sits on the left in confirm dialogs. Tests: not run.
- [Done] Add simplified view alternative (keep advanced view). User value: quick scan-and-clean with minimal controls. Technical approach: add a mode switch; simplified view hides advanced controls and uses defaults: hash-only, last 7 days, hash limit 500 MB, include subfolders, no name prefix, skip keep-choice and rename kept enabled; no results table; auto-delete duplicates while keeping newest with a clear confirmation. Effort: L. Dependencies: UX decision for mode switch and safety confirm. Risks: accidental deletes if defaults feel too aggressive. Result: added a view toggle with a simplified mode that applies fixed defaults, auto-deletes after a confirmation with a Review in Advanced option, and hides the results table. Tests: not run.
- [Done] UI layout audit + optimization. User value: reduce visual clutter, improve alignment/consistency, and prevent layout shifts from long messages. Technical approach: review layout for misaligned/different-sized buttons, overly long log/summary text, and empty spacing; propose tweaks such as consistent button sizing, dedicated message area with wrapping, and tighter spacing. Effort: M. Dependencies: none. Risks: UI polish changes could affect muscle memory. Result: full-group confirm dialog uses matching button heights with a left-aligned review action and smaller dialog button styling. Tests: not run.
- [Done] Group selection selects child rows + action button color cues + scan icon. User value: faster multi-row selection, clearer destructive-action cues, and a more discoverable scan button. Technical approach: expand Treeview selection when a group row is selected, tint delete actions red and scan green, and add a magnifying glass icon to Scan. Effort: S. Dependencies: ttk theme support for button colors. Risks: theme differences in button tinting. Result: group selection auto-selects child rows, delete buttons are tinted red, and Scan shows a magnifying glass with a green tint. Tests: not run.
- [Done] In-table selection + ソ?oDelete selectedソ?? workflow. User value: act on large result sets by selecting specific rows (e.g., sort by size and delete the largest duplicates immediately) without opening the keep-choice dialog for all groups. Technical approach: use native Treeview multi-select (no checkbox column), add a dedicated ソ?oDelete selectedソ?? button near the table actions plus a right-click context menu action for selected rows, and show a small ソ?oN files selected / M groups affectedソ?? indicator; ensure safe behavior for mixed group selections and when the selection includes all copies in a group, show a blocking confirm on delete with wording: Title ソ?oAll Copies Selectedソ??, body ソ?oYour selection includes every copy in the groups listed below. Continuing will delete all copies in those groups.ソ??, list label ソ?oFully selected groups:ソ??, buttons ソ?oReview Selectionソ?? (default) and ソ?oDelete Selected (Including Full Groups)ソ??. Effort: M. Dependencies: selection model should align with existing keep-choice dialog behavior. Risks: accidental full-group deletes and unclear selection state in large lists. Result: added Treeview multi-select, Delete selected actions (button + context menu), selection indicator, and full-group delete confirmation. Tests: not run.
- [Done] Align README and release artifacts (README references v1.1.0 while `dist/` contains 1.2.0/1.3.0). User value: accurate install/run guidance. Technical approach: update README, pick the current EXE/zip naming, and archive or remove older artifacts. Effort: S. Dependencies: decide the target version. Risks: removing files that users still rely on. Result: README now points to 1.4.0, older artifacts archived, new EXE built.
- [Done] Decide how to handle `.duplicate_cleaner_settings.json` files committed in repo and `dist/`. User value: avoid shipping user-specific paths and keep the repo clean. Technical approach: add runtime settings to `.gitignore` and provide a sanitized sample config for builds. Effort: S. Dependencies: packaging workflow agreement. Risks: builds may expect the committed settings file. Result: removed tracked settings files, added a sanitized sample, ignored runtime settings; Tests: not run.
- [Done] Hash size cap behavior for large files. User value: avoid silently skipping duplicates when hashing is capped. Technical approach: when size > cap, still group by non-hash criteria (size/name/mtime) or report skipped files in the UI. Effort: S. Dependencies: decision on desired behavior. Risks: slower scans if fallback grouping is enabled. Result: large files skip hashing but still group by other selected criteria with clearer UI messaging.
- [Done] Scan error handling in `gather_recent_files`. User value: scans do not fail on a single unreadable file. Technical approach: catch per-file `OSError`, track skipped count, and surface it in the summary. Effort: S. Dependencies: none. Risks: need clear messaging to avoid confusion. Result: unreadable files are skipped, counted, and reported in the scan summary.
- [Done] mtime precision when used as a criterion. User value: fewer false positives when files differ only by sub-second times. Technical approach: use `st_mtime_ns` or the full float; keep display formatting unchanged. Effort: S. Dependencies: none. Risks: small changes to grouping keys. Result: grouping uses full timestamp precision while display formatting stays the same. Tests: not run. Files: `delete_real_duplicates.py`, `docs/FEATURES.md`.
- [Done] Visual keep/delete indicators in the keep-choice dialog. User value: reduce mistakes by making keep vs delete choices obvious. Technical approach: add per-row state badges with icon + text and optional color accents; avoid color-only signals (include labels/legend), keep contrast high, and sync with the current selection. Effort: S. Dependencies: decide indicator style and Tkinter styling approach. Risks: color/theme accessibility and visual clutter in dense groups. Result: added a KEEP/DELETE status column with legend synced to the selection. Tests: not run. Files: `delete_real_duplicates.py`, `docs/FEATURES.md`.
- [Done] Keep-choice dialog hides filenames by default with a toggle to show full path+filename. User value: reduce visual clutter in the keep/delete popup for long names. Technical approach: show directory path only (omit filename), add a dialog toggle to show full path+filename (current behavior), and persist the setting in `.duplicate_cleaner_settings.json`. Effort: S. Dependencies: confirm toggle placement (dialog-only vs global setting). Risks: users might miss filenames without a clear toggle label. Result: dialog defaults to folder-only display with a toggle to show full paths, and the setting persists.
- [Done] Confirm-delete dialog text accuracy. User value: avoid misleading messaging when a user chooses a non-newest file to keep. Technical approach: adjust confirmation copy to reflect actual selections. Effort: XS. Dependencies: none. Risks: none. Result: confirm delete copy now reflects the selected keep file in each group. Tests: not run.
- [Done] Guard UI callbacks after window close during scans. User value: avoid `TclError` if the window closes mid-scan. Technical approach: add a shutdown flag or `winfo_exists()` checks before `after` callbacks. Effort: S. Dependencies: none. Risks: none. Result: UI callbacks skip updates after close to avoid `TclError` during scans. Tests: not run.
- [Done] Debounce filter re-rendering. User value: responsive UI on large result sets. Technical approach: add a short `after` delay and cancel pending filter renders on keystroke. Effort: S. Dependencies: none. Risks: minor UI behavior change. Result: filter re-rendering is debounced with pending jobs canceled per keystroke. Tests: not run.
- [Done] Safer size calculation before delete. User value: avoid crashes if files disappear between scan and delete. Technical approach: wrap `path.stat()` in try/except and treat missing files as size 0. Effort: XS. Dependencies: none. Risks: none. Result: size estimates skip missing files instead of crashing. Tests: not run.

## Next
- [Planned] Reduce scan memory when hashing is off. User value: lower RAM usage on large folders. Technical approach: let `find_duplicate_groups` stream inputs when `use_hash` is False; avoid `list(entries)` in `_run_scan_thread`. Effort: M. Dependencies: refactor grouping logic. Risks: behavior changes in edge cases if not tested.
- [Planned] Faster traversal with `os.scandir`/`os.walk`. User value: faster scans on large trees. Technical approach: replace `Path.rglob` with `os.walk` and reuse `entry.stat()` to avoid double stat calls. Effort: M. Dependencies: refactor `gather_recent_files`. Risks: path handling differences on Windows.
- [Planned] Add automated tests for core matching logic. User value: prevent regressions in `gather_recent_files` and `find_duplicate_groups`. Technical approach: introduce unit tests with fixture files and temp directories. Effort: M. Dependencies: test data harness. Risks: file-system tests can be flaky on CI without careful setup.
- [Planned] Scrollable keep-choice dialog for large duplicate sets. User value: UI remains usable when there are many groups. Technical approach: add a scrollable container or stepper per group. Effort: M. Dependencies: Tkinter layout work. Risks: increased UI complexity.
- [Planned] Extract core scan/grouping logic into a non-UI module. User value: better testability and simpler UI class. Technical approach: move scan/hash/group functions into a separate module with clean inputs/outputs. Effort: M. Dependencies: update imports and tests. Risks: refactor bugs.

## Later
- [Planned] Optional hashing thread pool. User value: faster hashing on SSDs and multi-core CPUs. Technical approach: parallelize hashing within size buckets with a bounded executor. Effort: L. Dependencies: careful UI progress handling. Risks: IO contention and increased CPU use.
- [Planned] Implement optional checks listed in the Help dialog (MIME/type, media metadata, embedded checksums). User value: tighter duplicate detection without full hashing. Technical approach: extend grouping keys and add optional dependencies (e.g., python-magic, pillow, mutagen). Effort: L. Dependencies: new libraries and UI configuration. Risks: performance cost and platform-specific edge cases.

## Pause / Abandon checklist
- Update the item status and add a short reason.
- Note any partial code paths and the next step needed to resume.
- Record commands/tests run in `docs/PROJECT_LOG.md`.

